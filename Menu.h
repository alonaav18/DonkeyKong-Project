#pragma once
#include <iostream>
#include <windows.h>
#include <conio.h>
#include <vector>
#include <string>
#include <filesystem>
#include <algorithm>

#include "Game.h"
#include "gameConfig.h"
#include "utils.h"
#include "AutomaticGame.h"
#include "ManualGame.h"
#include "SilentGame.h"


class Menu {

	bool isSave = false;
	bool specialMode = gameConfig::DEFAULT_SPECIAL_MODE;	// Game with special mode - BONUS
	std::vector<std::string> filenames = {};
	
	const char* PREMENU[gameConfig::GAME_HEIGHT] = {
	"********************************************************************************",
	"*                                                                              *",
	"*                                                                              *",
	"*       $$$$$$$\\                      $$\\                                      *",
	"*       $$  __$$\\                     $$ |                                     *",
	"*       $$ |  $$ | $$$$$$\\  $$$$$$$\\  $$ |  $$\\  $$$$$$\\  $$\\   $$\\            *",
	"*       $$ |  $$ |$$  __$$\\ $$  __$$\\ $$ | $$  |$$  __$$\\ $$ |  $$ |           *",
	"*       $$ |  $$ |$$ /  $$ |$$ |  $$ |$$$$$$  / $$$$$$$$ |$$ |  $$ |           *",
	"*       $$ |  $$ |$$ |  $$ |$$ |  $$ |$$  _$$<  $$   ____|$$ |  $$ |           *",
	"*       $$$$$$$  |\\$$$$$$  |$$ |  $$ |$$ | \\$$\\ \\$$$$$$$\\ \\$$$$$$$ |           *",
	"*       \\_______/  \\______/ \\__|  \\__|\\__|  \\__| \\_______| \\____$$ |           *",
	"*                                                         $$\\   $$ |           *",
	"*        $$\\   $$\\                                        \\$$$$$$  |           *",
	"*        $$ | $$  |                                        \\______/            *",
	"*        $$ |$$  / $$$$$$\\  $$$$$$$\\   $$$$$$\\                                 *",
	"*        $$$$$  / $$  __$$\\ $$  __$$\\ $$  __$$\\                                *",
	"*        $$  $$<  $$ /  $$ |$$ |  $$ |$$ /  $$ |                               *",
	"*        $$ |\\$$\\ $$ |  $$ |$$ |  $$ |$$ |  $$ |                               *",
	"*        $$ | \\$$\\\\$$$$$$  |$$ |  $$ |\\$$$$$$$ |                               *",
	"*        \\__|  \\__|\\______/ \\__|  \\__| \\____$$ |                               *",
	"*                                     $$\\   $$ |                               *",
	"*                                     \\$$$$$$  |                               *",
	"*                                      \\______/                                *",
	"*                                                                              *",
	"********************************************************************************"
	};


	const char* MENU[gameConfig::GAME_HEIGHT] = {

		// 01234567890123456789012345678901234567890123456789012345678901234567890123456789
		  "********************************************************************************", // 0
		  "*                                                                              *", // 1
		  "*                                                                              *", // 2
          "*                    .___  ___.  _______ .__   __.  __    __                   *", // 3
          "*                    |   \\/   | |   ____||  \\ |  | |  |  |  |                  *", // 4
          "*                    |  \\  /  | |  |__   |   \\|  | |  |  |  |                  *", // 5
          "*                    |  |\\/|  | |   __|  |  . `  | |  |  |  |                  *", // 6
          "*                    |  |  |  | |  |____ |  |\\   | |  `--'  |                  *", // 7
          "*                    |__|  |__| |_______||__| \\__|  \\______/                   *", // 8
		  "*                                                                              *", // 9
		  "*                                                                              *", // 10
		  "*                                                                              *", // 11
		  "* ---------------------------------------------------------------------------- *", // 12
		  "*                                                                              *", // 13
		  "*    (1) Start a New Game                                                      *", // 14
		  "*                                                                              *", // 15
		  "*    (2) Special Edition :                                                     *", // 16
		  "*                                                                              *", // 17
		  "*    (3) Start from a specific screen                                          *", // 23
		  "*                                                                              *", // 21
		  "*    (8) Present Instructions And Keys                                         *", // 18
		  "*                                                                              *", // 19
		  "*    (9) Exit Game                                                             *", // 20
		  "*                                                       - Alona & Hilay inc.   *", // 22
		  "********************************************************************************"  // 24
	};


	const char* FILE_SELECT[gameConfig::GAME_HEIGHT] = {

		// 01234567890123456789012345678901234567890123456789012345678901234567890123456789
		  "********************************************************************************", // 0
		  "*  return                                                                      *", // 1
		  "*   ESC                                                                        *", // 2
		  "*                                                                              *", // 3
		  "*                                                                              *", // 4
		  "*                                                                              *", // 5
		  "*                                                                              *", // 6
		  "*                                                                              *", // 7
		  "*                                                                              *", // 8
		  "*                                                                              *", // 9
		  "*                                                                              *", // 10
		  "*                                                                              *", // 11
		  "*                                                                              *", // 12
		  "*                                                                              *", // 13
		  "*                                                                              *", // 14
		  "*                                                                              *", // 15
		  "*                                                                              *", // 16
		  "*                                                                              *", // 17
		  "*                                                                              *", // 18
		  "*                                                                              *", // 19
		  "*                                                                              *", // 20
		  "*    a/A                                                               d/D     *", // 21
		  "*    back                                                              next    *", // 22
		  "*                                                                              *", // 23
		  "********************************************************************************"  // 24
	};

	const char* NO_FILES_FOUND[gameConfig::GAME_HEIGHT] = {

		// 01234567890123456789012345678901234567890123456789012345678901234567890123456789
		  "********************************************************************************", // 0
		  "*                                                                              *", // 1
		  "*                                                                              *", // 2
		  "*                                                                              *", // 3
		  "*                                                                              *", // 4
		  "*                                No Files Found                                *", // 5
		  "*                                                                              *", // 6
		  "*                                                                              *", // 7
		  "*                                                                              *", // 8
		  "*                                                                              *", // 9
		  "*                                                                              *", // 10
		  "*                                                                              *", // 11
		  "*                                                                              *", // 12
		  "*                                                                              *", // 13
		  "*                                                                              *", // 14
		  "*                                                                              *", // 15
		  "*                                                                              *", // 16
		  "*                                                                              *", // 17
		  "*                                                                              *", // 18
		  "*                                                                              *", // 19
		  "*                                                                              *", // 20
		  "*                                                                              *", // 21
		  "*                                                                              *", // 22
		  "*                                                                              *", // 23
		  "********************************************************************************"  // 24
	};



	const char* INSTRUCTIONS[gameConfig::GAME_HEIGHT] = {
	  // 01234567890123456789012345678901234567890123456789012345678901234567890123456789
		"********************************************************************************", // 0
		"*                                                                              *", // 1
		"*    BACK TO MAIN MENU                                                         *", // 2
		"*       PRESS ESC                                                              *", // 3
		"*                                                                              *", // 4
		"*                                 Instructions:                                *", // 5
		"*                                                                              *", // 6
		"*                                                                              *", // 7
		"*                                                                              *", // 8
		"* ---------------------------------------------------------------------------- *", // 9
		"*        ACTION       KEY                                                      *", // 10
		"*  ----------------------------               Game Instructions:               *", // 11
		"*        PAUSE       ESC                                                       *", // 12
		"*        UP          (W/w)                 You are Mario (@) trying to         *", // 13
		"*        DOWN/Climb  (X/x)                   save the princess ($)             *", // 14
		"*        RIGHT       (D/d)                 Be careful from Donkey Kong (&)     *", // 15
		"*        LEFT        (A/a)                   and his barrels (O)               *", // 16
		"*        STAY        (S/s)                 Try not to fall ...                 *", // 17
		"*                                                                              *", // 18
		"*                                                                              *", // 19
		"* ---------------------------------------------------------------------------- *", // 20
		"*                                                                              *", // 21
		"*                                                       - Alona & Hilay inc.   *", // 22
		"*                                                                              *", // 23
		"********************************************************************************"  // 24
	};



public:
	Menu(bool _isSave = false) : isSave(_isSave) {
		getAllBoardFilenames(filenames);
		ShowConsoleCursor(false);	// Hiding the printing cursor
	}

	void startMenu();
	void mainMenu();
	void startFromFileScreen();
	
	void startSilent() {
		SilentGame(1, filenames, 0).run();
	}
	void startLoad() { //FIX
		AutomaticGame(1, filenames, 0).run();
	}

	void getAllBoardFilenames(std::vector<std::string>& vec_to_fill);
	void printScreensPage(int page);
	void showPreMenuScreen() const;
	void instructionsScreen() const;

	void printMainMenu() const;

	bool getSpecialMode() const { return specialMode; }
	void setSpecialMode(bool state) { specialMode = state; }
	void toggleSpecialMode() { specialMode = !specialMode; }
	void printSpecialMode() const;
};